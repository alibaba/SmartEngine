<?xml version="1.0" encoding="UTF-8"?>
<definitions id="STANDARD_EXCHANGE_WORKFLOW" version="1.0.0"
             xmlns="http://www.omg.org/spec/BPMN/20100524/MODEL"
             xmlns:smart="http://smart.alibaba-inc.com/schema/process"
             xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" targetNamespace="Examples">

    <process id="STANDARD_EXCHANGE_PROCESS" isExecutable="true">
        <startEvent id="theStart"></startEvent>

        <sequenceFlow id="flow1" sourceRef="theStart" targetRef="exclusiveGatewayForCreate"></sequenceFlow>

        <exclusiveGateway id="exclusiveGatewayForCreate" name="exclusiveGatewayForCreate"></exclusiveGateway>

        <sequenceFlow id="flow2" sourceRef="exclusiveGatewayForCreate" targetRef="pre_order">
            <conditionExpression xsi:type="mvel"><![CDATA[amspmAction == "goto_pre_order"]]></conditionExpression>
        </sequenceFlow>

        <sequenceFlow id="flow3" sourceRef="exclusiveGatewayForCreate" targetRef="formal_order">
            <conditionExpression xsi:type="mvel"><![CDATA[amspmAction == "goto_formal_order"]]></conditionExpression>
        </sequenceFlow>

        <sequenceFlow id="flow4" sourceRef="pre_order" targetRef="confirm_order"></sequenceFlow>
        <sequenceFlow id="flow5" sourceRef="confirm_order" targetRef="exclusivegatewayForPay"></sequenceFlow>
        <exclusiveGateway id="exclusivegatewayForPay" name="exclusivegatewayForPay"></exclusiveGateway>

        <sequenceFlow id="flow6" sourceRef="exclusivegatewayForPay" targetRef="wait_customer_funds_arrive">
            <conditionExpression xsi:type="mvel"><![CDATA[amspmAction == "goto_pay"]]></conditionExpression>
        </sequenceFlow>
        <sequenceFlow id="flow7" sourceRef="exclusivegatewayForPay" targetRef="endevent4">
            <conditionExpression xsi:type="mvel"><![CDATA[amspmAction == "goto_close"]]></conditionExpression>
        </sequenceFlow>

        <sequenceFlow id="flow8" sourceRef="formal_order" targetRef="wait_customer_funds_arrive"></sequenceFlow>


        <sequenceFlow id="flow9" sourceRef="fund_delivery" targetRef="fund_delivery_ack"></sequenceFlow>
        <sequenceFlow id="flow10" sourceRef="fund_delivery_ack" targetRef="endevent2"></sequenceFlow>


        <sequenceFlow id="flow11" sourceRef="wait_customer_funds_arrive" targetRef="exclusivegatewayForDelivery"></sequenceFlow>

        <exclusiveGateway id="exclusivegatewayForDelivery" name="exclusivegatewayForDelivery"></exclusiveGateway>
        <sequenceFlow id="flow12" sourceRef="exclusivegatewayForDelivery" targetRef="fund_delivery">
            <conditionExpression xsi:type="mvel"><![CDATA[amspmAction == "goto_delivery"]]></conditionExpression>
        </sequenceFlow>
        <sequenceFlow id="flow13" sourceRef="exclusivegatewayForDelivery" targetRef="refund">
            <conditionExpression xsi:type="mvel"><![CDATA[amspmAction == "goto_refund"]]></conditionExpression>
        </sequenceFlow>

        <sequenceFlow id="flow14" sourceRef="refund" targetRef="endevent3"></sequenceFlow>

        <receiveTask id="pre_order" name="预下单" smart:class="com.alibaba.smart.framework.engine.test.CreateOrderDelegation"></receiveTask>
        <receiveTask id="confirm_order" name="下单确认" smart:class="com.alibaba.smart.framework.engine.test.CreateOrderDelegation"></receiveTask>
        <receiveTask id="formal_order" name="正式下单" smart:class="com.alibaba.smart.framework.engine.test.CreateOrderDelegation"></receiveTask>
        <receiveTask id="wait_customer_funds_arrive" name="等待客户资金到账"></receiveTask>
        <endEvent id="endevent2" name="End"></endEvent>
        <receiveTask id="refund" name="资金反平处理" smart:class="com.alibaba.smart.framework.engine.test.CreateOrderDelegation"></receiveTask>
        <endEvent id="endevent3" name="End"></endEvent>
        <receiveTask id="fund_delivery" name="资金交割" smart:class="com.alibaba.smart.framework.engine.test.CreateOrderDelegation"></receiveTask>
        <receiveTask id="fund_delivery_ack" name="回执确认" smart:class="com.alibaba.smart.framework.engine.test.CreateOrderDelegation"></receiveTask>
        <endEvent id="endevent4" name="End"></endEvent>
    </process>

</definitions>